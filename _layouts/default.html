<!doctype html>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ site.title | default: "Stone Tablet Factory 2017" }}</title>
    
    <!-- NES.css -->
    <link href="https://unpkg.com/nes.css@latest/css/nes.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">
    
    <!-- Analytics -->
    {% if site.google_analytics %}
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', '{{ site.google_analytics }}');
    </script>
    {% endif %}

    {% seo %}
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}">
    
    <!-- Web3 and dependent scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.8.0/web3.min.js"></script>
    <!-- Core dependencies -->
    <script src="{{ '/assets/js/get_tablet_instance.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/get_tablet_factory_instance.js' | relative_url }}"></script>
    
    <!-- Utility scripts -->
    <script src="{{ '/assets/js/utils.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/MetaMask_check.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/wallet_address_click.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/sort_table.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/connect_wallet.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/theme_switcher.js' | relative_url }}"></script>
    
    <!-- Feature scripts -->
    <script src="{{ '/assets/js/show_records.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/add_record.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/make_tablet.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/show_tablets.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/get_owner.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/get_scribes.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/add_scribe.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/remove_scribe.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/transfer_ownership.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/update_bytes_limit.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/open_tab.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/populate_tablet_dropdowns.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/list_all_tablets.js' | relative_url }}"></script>
  </head>
  
  <body class="nes-container is-dark with-title">
    <h1 class="nes-text is-primary">{{ site.title | default: site.github.repository_name }}</h1>
    
    <!-- Wallet Connection -->
    <div class="row">
      <div id="connect-wallet" class="nes-container with-title centered-container">
        <!-- Wallet controls from index.html -->
      </div>
    </div>

    <!-- Tab Navigation -->
    {% if site.show_menu %}
    <div class="centered-container">
      <div class="nes-container with-title">
        <ul>
          <li><a role="button" onclick="open_tab('factory_tab')" class="nes-btn">Factory</a></li>
          <li><a role="button" onclick="open_tab('tablet_tab')" class="nes-btn">Tablet</a></li>
          <li><a role="button" onclick="open_tab('settings_tab')" class="nes-btn">Settings</a></li>
        </ul>
      </div>
    </div>
    {% endif %}

    <!-- Main Content -->
    <div class="nes-container with-title centered-container">
      {{ content }}
    </div>

    <!-- Footer -->
    <footer class="nes-container">
      {% if site.github.is_project_page %}
      <p>This project is maintained by <a href="{{ site.github.owner_url }}">{{ site.github.owner_name }}</a></p>
      {% endif %}
      <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
    </footer>

    <!-- Initialize scripts -->
    <script>
      // Jekyll configuration variables
      window.config = {
          networkId: {{ site.network_id }},
          factoryAddress: "{{ site.factory_address }}",
          title: "{{ site.title }}"
      };

      document.addEventListener("DOMContentLoaded", () => {
          window.initializeWallet();
          window.initializeThemeSwitcher();
          document.getElementById("showTabletsButton").addEventListener("click", show_tablets);
          
          // Initialize tabs if enabled
          {% if site.show_menu %}
          window.initializeTabs();
          {% endif %}
      });
    </script>
  </body>
</html>